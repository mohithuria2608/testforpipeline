import * as fs from 'fs';
import * as Constant from '../../constant'
import { consolelog } from '../../utils'
import * as ENTITY from '../../entity'

export class PromotionController {
    constructor() { }

    /**
     * @method POST
     * @description : Post bulk menu data
     * */
    async postMenu() {
        try {
            // let rawdata = fs.readFileSync(__dirname + '/../../../model/menu.json', 'utf-8');
            // let menu = JSON.parse(rawdata);
            // for (const iterator of menu) {
            //     ENTITY.MenuE.post(iterator)
            // }
            return {}
        } catch (err) {
            consolelog(process.cwd(), "postMenu", err, false)
            return Promise.reject(err)
        }
    }

    /**
    * @method GET
    * @description gets the list of promotions
    * */
    async getPromotionsList(headers: ICommonRequest.IHeaders, payload: IPromotionRequest.IFetchPromotion) {
        try {
            // return {
            //     list: await ENTITY.PromotionE.getPromotions(),
            //     currentPage: parseInt(payload.page),
            //     nextPage: -1
            // };

            let testlist = JSON.parse("[ { couponId: 3,\n    couponCode: 'KFC 10',\n    promotionType: 'by_percent',\n    discountAmount: 10,\n    maxDiscountQty: 1,\n    usesPerCoupon: 1000,\n    usesPerCust: 10,\n    timesUsed: 1,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: '10% off upto max 10',\n    shortDesc: '%s discount off with a cap of the max amount',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 4,\n    couponCode: 'KFC 15',\n    promotionType: 'cart_fixed',\n    discountAmount: 15,\n    maxDiscountQty: 15,\n    usesPerCoupon: 10,\n    usesPerCust: 1,\n    timesUsed: 0,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: '15 $off',\n    shortDesc: 'Absolute discount',\n    activeFlag: 1,\n    posId: 111,\n    maxDiscountAmt: 100,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 2,\n    couponCode: 'FREE DEL',\n    promotionType: 'by_percent',\n    discountAmount: 0,\n    maxDiscountQty: NaN,\n    usesPerCoupon: 0,\n    usesPerCust: 1,\n    timesUsed: 0,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: 'Free Delivery',\n    shortDesc: 'Free Shipping with cart price greater than 200',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 5,\n    couponCode: 'FREE ITEM',\n    promotionType: 'buy_x_get_y',\n    discountAmount: 1,\n    maxDiscountQty: NaN,\n    usesPerCoupon: 100,\n    usesPerCust: 100,\n    timesUsed: 0,\n    dateFrom: '2019-12-12',\n    dateTo: '2019-12-31',\n    ruleName: 'Buy X get y free of specific category',\n    shortDesc: 'Buy X get y free of specific category',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 6,\n    couponCode: 'KFC15',\n    promotionType: 'by_percent',\n    discountAmount: 15,\n    maxDiscountQty: 15,\n    usesPerCoupon: 1000,\n    usesPerCust: 1000,\n    timesUsed: 0,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: '15% off',\n    shortDesc: '15% off based on subtotal',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 7,\n    couponCode: 'KFCWQ860URUHD7NEW',\n    promotionType: 'by_percent',\n    discountAmount: 100,\n    maxDiscountQty: 1,\n    usesPerCoupon: 4,\n    usesPerCust: 2,\n    timesUsed: 4,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: 'FREEPEP',\n    shortDesc: 'free pepsi',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 7,\n    couponCode: 'KFC9TX8I7OC892NEW',\n    promotionType: 'by_percent',\n    discountAmount: 100,\n    maxDiscountQty: 1,\n    usesPerCoupon: 4,\n    usesPerCust: 2,\n    timesUsed: 4,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: 'FREEPEP',\n    shortDesc: 'free pepsi',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 7,\n    couponCode: 'KFCJP2IZXPUO8XNEW',\n    promotionType: 'by_percent',\n    discountAmount: 100,\n    maxDiscountQty: 1,\n    usesPerCoupon: 4,\n    usesPerCust: 2,\n    timesUsed: 4,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: 'FREEPEP',\n    shortDesc: 'free pepsi',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 7,\n    couponCode: 'KFCERUNQBBOSUINEW',\n    promotionType: 'by_percent',\n    discountAmount: 100,\n    maxDiscountQty: 1,\n    usesPerCoupon: 4,\n    usesPerCust: 2,\n    timesUsed: 4,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: 'FREEPEP',\n    shortDesc: 'free pepsi',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 7,\n    couponCode: 'KFC4ZYIHFZTN6WNEW',\n    promotionType: 'by_percent',\n    discountAmount: 100,\n    maxDiscountQty: 1,\n    usesPerCoupon: 4,\n    usesPerCust: 2,\n    timesUsed: 4,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: 'FREEPEP',\n    shortDesc: 'free pepsi',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 7,\n    couponCode: 'KFCVJFSLUFU4OLNEW',\n    promotionType: 'by_percent',\n    discountAmount: 100,\n    maxDiscountQty: 1,\n    usesPerCoupon: 4,\n    usesPerCust: 2,\n    timesUsed: 4,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: 'FREEPEP',\n    shortDesc: 'free pepsi',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 7,\n    couponCode: 'KFC6FWCIQ8M5YBNEW',\n    promotionType: 'by_percent',\n    discountAmount: 100,\n    maxDiscountQty: 1,\n    usesPerCoupon: 4,\n    usesPerCust: 2,\n    timesUsed: 4,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: 'FREEPEP',\n    shortDesc: 'free pepsi',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 7,\n    couponCode: 'KFCEP6XIDT7KIJNEW',\n    promotionType: 'by_percent',\n    discountAmount: 100,\n    maxDiscountQty: 1,\n    usesPerCoupon: 4,\n    usesPerCust: 2,\n    timesUsed: 4,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: 'FREEPEP',\n    shortDesc: 'free pepsi',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 7,\n    couponCode: 'KFCBOGBEV29KCFNEW',\n    promotionType: 'by_percent',\n    discountAmount: 100,\n    maxDiscountQty: 1,\n    usesPerCoupon: 4,\n    usesPerCust: 2,\n    timesUsed: 4,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: 'FREEPEP',\n    shortDesc: 'free pepsi',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 7,\n    couponCode: 'KFCRH5FD9K0T98NEW',\n    promotionType: 'by_percent',\n    discountAmount: 100,\n    maxDiscountQty: 1,\n    usesPerCoupon: 4,\n    usesPerCust: 2,\n    timesUsed: 4,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: 'FREEPEP',\n    shortDesc: 'free pepsi',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 7,\n    couponCode: 'KFCCP5GG3FZZ9ZNEW',\n    promotionType: 'by_percent',\n    discountAmount: 100,\n    maxDiscountQty: 1,\n    usesPerCoupon: 4,\n    usesPerCust: 2,\n    timesUsed: 4,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: 'FREEPEP',\n    shortDesc: 'free pepsi',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 7,\n    couponCode: 'KFCUSMC7IDG5RTNEW',\n    promotionType: 'by_percent',\n    discountAmount: 100,\n    maxDiscountQty: 1,\n    usesPerCoupon: 4,\n    usesPerCust: 2,\n    timesUsed: 4,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: 'FREEPEP',\n    shortDesc: 'free pepsi',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 7,\n    couponCode: 'KFCF23YILZ4755NEW',\n    promotionType: 'by_percent',\n    discountAmount: 100,\n    maxDiscountQty: 1,\n    usesPerCoupon: 4,\n    usesPerCust: 2,\n    timesUsed: 4,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: 'FREEPEP',\n    shortDesc: 'free pepsi',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 7,\n    couponCode: 'KFCOBS16S3S3W3NEW',\n    promotionType: 'by_percent',\n    discountAmount: 100,\n    maxDiscountQty: 1,\n    usesPerCoupon: 4,\n    usesPerCust: 2,\n    timesUsed: 4,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: 'FREEPEP',\n    shortDesc: 'free pepsi',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 7,\n    couponCode: 'KFCQ8AW2J2OL4YNEW',\n    promotionType: 'by_percent',\n    discountAmount: 100,\n    maxDiscountQty: 1,\n    usesPerCoupon: 4,\n    usesPerCust: 2,\n    timesUsed: 4,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: 'FREEPEP',\n    shortDesc: 'free pepsi',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' },\n  { couponId: 7,\n    couponCode: 'KFC10JSP983FCZNEW',\n    promotionType: 'by_percent',\n    discountAmount: 100,\n    maxDiscountQty: 1,\n    usesPerCoupon: 4,\n    usesPerCust: 2,\n    timesUsed: 4,\n    dateFrom: '2019-12-01',\n    dateTo: '2019-12-30',\n    ruleName: 'FREEPEP',\n    shortDesc: 'free pepsi',\n    activeFlag: 1,\n    posId: 0,\n    maxDiscountAmt: 0,\n    isVisible: 0,\n    temsAndConds: '' } ]");

            let returnList = testlist.slice(((parseInt(payload.page.toString()) - 1) * 10), (parseInt(payload.page.toString()) * 10))
            return { "list": returnList, "nextPage": testlist[((parseInt(payload.page.toString()) * 10) + 1)] ? parseInt(payload.page.toString()) + 1 : -1, currentPage: parseInt(payload.page.toString()) }
        } catch (err) {
            consolelog(process.cwd(), "getPromotionsList", err, false)
            return Promise.reject(err)
        }
    }
}

export const promotionController = new PromotionController();